{"version":3,"sources":["../src/components.js"],"names":[],"mappings":"AAAA,OAAO,KAAP,IAAgB,SAAhB,QAAiC,OAAjC;AACA,SAAS,OAAT,QAAwB,aAAxB;AACA,SAAS,kBAAT,QAAmC,OAAnC;;AAEA,SAAS,OAAT,QAAwB,WAAxB;;AAEA,OAAO,MAAM,uBAAuB,CAAC,YAAY,aAAZ,KAA8B;AACjE,SAAW,MAAM,SAAN,CAAX;AACA,YAAY,mBAAmB,OAAnB,EAA4B,QAA5B,CAAZ,CAFiE;AAGjE,CAAC,EAAE,QAAF;AACD,OADC,EACM,UADN,EACkB,IADlB,EACwB,IADxB,EAAD,KACmC;AACnC;AACE,0CAAQ,WAAW,SAAS,EAAC,KAAD,EAAQ,UAAR,EAAoB,IAApB,EAA0B,IAA1B,EAAT,CAAX;AACH,eAAW,MAAX,GAAoB,WAAW,GAAX;AACvB,aAAW,6BAAK,KAAK,KAAL,EAAL,EAAmB,MAAM,KAAN,EAAa,EAAC,KAAD,EAAQ,IAAR,EAAc,IAAd,EAAoB,UAApB,EAAgC,KAAhC,EAAb,CAAnB,CAAX,CADG;;AAGD,yCAHC,CAFP,EADmC,CADnC,CAHkC,CAApC;;;;;AAeA,OAAO,MAAM,QAAQ,CAAC,YAAY,aAAZ,KAA8B;AAClD,SAAW,MAAM,SAAN,CAAX;AACA,YAAY,mBAAmB,OAAnB,EAA4B,QAA5B,CAAZ,CAFkD;AAGjD,MAAM,WAAN,CAAkB;AACnB,uBAAqB;AACnB,SAAK,KAAL,CAAW,QAAX,CAAoB,KAAK,KAAL,CAAW,EAAX,EAAe,KAAK,KAAL,CAAW,QAAX,CAAnC,CADmB,CAArB;;AAGA,wBAAsB,QAAtB,EAAgC;AAC9B,UAAM,EAAE,GAAF,EAAO,QAAP,EAAiB,QAAjB,EAA2B,EAA3B,KAAkC,KAAK,KAAL,CADV;AAE9B,QAAI,aAAa,KAAb,CAF0B;AAG9B,QAAI,OAAO,SAAS,EAAT,EAAa;AACtB,mBAAa,IAAb,CADsB,CAAxB;;AAGK,QAAI,SAAS,QAAT,OAAwB,SAAS,QAAT,CAAkB,QAAlB,EAAxB,EAAsD;AAC7D,mBAAa,IAAb,CAD6D,CAA1D;;AAGA,QAAI,GAAJ,EAAS;AACZ,UAAI,IAAI,MAAJ,KAAe,SAAS,GAAT,CAAa,MAAb,EAAqB;AACtC,qBAAa,IAAb,CADsC,CAAxC;AAEO;AACL,YAAI,IAAI,IAAI,MAAJ,CADH;AAEL,eAAO,GAAP,EAAY;AACV,cAAI,KAAK,SAAL,CAAe,IAAI,CAAJ,CAAf,MAA2B,KAAK,SAAL,CAAe,SAAS,GAAT,CAAa,CAAb,CAAf,CAA3B,EAA4D;AAC9D,yBAAa,IAAb,CAD8D,CAAhE,CADF,CAJF,CADG;;;;;;AAaL,QAAI,UAAJ,EAAgB;AACd,eAAS,SAAS,EAAT,EAAa,SAAS,QAAT,CAAtB,CADc;AAEd,aAAO,IAAP,CAFc,CAAhB;;AAIA,WAAO,KAAP,CA1B8B,CAAhC;;;AA6BA,yBAAuB;;;GAAvB;;AAKA,WAAS;AACP,WAAO,qCAAP,CADO,CAAT,EAtCC,CAHiD,CAA/B,CAArB;;;;AA8CA,OAAO,MAAM,cAAc,CAAC,YAAY,aAAZ,KAA8B;AACxD,SAAW,MAAM,SAAN,CAAX;AACA,YAAY,mBAAmB,OAAnB,EAA4B,QAA5B,CAAZ,CAFwD;AAGxD,CAAC,EAAE,QAAF;AACD,YADC,EACW,IADX,EACiB,IADjB,EAAD;AAEI;AACJ,SAAO,SAAS,EAAE,IAAF,EAAQ,IAAR,EAAc,UAAd,EAAT,CAAP,CADI,CAFJ,CAHyB,CAA3B","file":"components.js","sourcesContent":["import React, { PropTypes } from 'react'\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\n\nimport { ACTIONS } from './reducer'\n\nexport const LayerStackMountPoint = (namespace = 'layer_stack') => connect(\n  (store) => store[namespace],\n  dispatch => bindActionCreators(ACTIONS, dispatch)\n)(({ renderFn, // from props\n  views, displaying, show, hide}) => { // from redux\n  return (\n    <div> { renderFn ? renderFn({views, displaying, show, hide})\n      : (displaying.length ? displaying.map (\n      (index) => <div key={index}>{ views[index]({index, show, hide, displaying, views}) }</div>\n    )\n      : <noscript />) }\n    </div>\n  )\n});\n\nexport const Layer = (namespace = 'layer_stack') => connect(\n  (store) => store[namespace],\n  dispatch => bindActionCreators(ACTIONS, dispatch)\n)((React.createClass({\n  componentWillMount() {\n    this.props.register(this.props.id, this.props.renderFn);\n  },\n  shouldComponentUpdate(newProps) {\n    const { use, renderFn, register, id } = this.props;\n    let needUpdate = false;\n    if (id !== newProps.id) {\n      needUpdate = true;\n    }\n    else if (renderFn.toString() !== newProps.renderFn.toString()) {\n      needUpdate = true;\n    }\n    else if (use) {\n      if (use.length !== newProps.use.length) {\n        needUpdate = true;\n      } else {\n        let i = use.length;\n        while (i--) {\n          if (JSON.stringify(use[i]) !== JSON.stringify(newProps.use[i])) {\n            needUpdate = true;\n          }\n        }\n      }\n    }\n\n    if (needUpdate) {\n      register(newProps.id, newProps.renderFn);\n      return true;\n    }\n    return false;\n  },\n\n  componentWillUnmount() {\n    // TODO: garbage collection\n    // this.props.unregister(this.props.id)\n  },\n\n  render() {\n    return <noscript />\n  }\n})));\n\nexport const LayerToggle = (namespace = 'layer_stack') => connect(\n  (store) => store[namespace],\n  dispatch => bindActionCreators(ACTIONS, dispatch)\n)(({ renderFn, // from props\n  displaying, show, hide, // from redux\n}) => {\n  return renderFn({ show, hide, displaying });\n});"]}